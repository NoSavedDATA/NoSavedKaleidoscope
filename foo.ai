def int producer(int channel ch)
    int i = 0
    while i < 100000
        ch <- i
        i = i + 1

	ch.terminate()

def int consumer(int channel ch)
    int x
	int w = tid()
	print("start thread: " + w)
    while true
        x <- ch
		if x==-1
			break
		print(w + ": " + x)





main
	int channel ch
	finish
		async producer(ch)

		asyncs 20 consumer(ch)


